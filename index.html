<!DOCTYPE html>
<html dir = "rtl" lang ="ar">
<head>
<title>أنشئ سلسلتك في أقل من دقيقة</title>
<link rel="stylesheet" href="css/style.css" />
<meta charset="utf-8">
</head>
<body>
<h1 style="text-align: center;">إنشاء سلسلة التمارين</h1>
<dl style="text-align: center;">
  <dt></dt>
</dl>
<h2 style="text-align: center;">في أقل من دقيقة</h2>
  <dt></dt>
    <h3>تقدم هذه الصفحة لزوارها الكرام مجموعة من التمارين الخاصة
بمادة الفيزياء والكيمياء للسلك الثانوي التأهيلي وفق المنهج التعليمي
المغربي والتي من خلالها يمكنك أخي الزائر أختي الزائرة إنشاء سلسلة
التمارين الخاصة بك. 
<br/>
يتضمن الموقع حاليا :

</h3>
<br/><br/>
<fieldset id="section-2">
<legend> إحصائيات </legend>
<br/>
<label for="nom_prenom">الجذع المشترك العلمي :</label> 
<input id="tc" name="nom_prenom" type="text" readonly style="text-align: center;"/>
<label for="nom_prenom">تمرينا</label> <br />
<label for="lycee">الأولى باك علوم تجريبية :</label> 
<input id="bac1" name="lycee" type="text" readonly style="text-align: center;" /> 
<label for="nom_prenom">تمرينا</label> <br />
<label for="niveau">الثانية باك علوم الحياة والأرض :</label> 
<input id="bac2" name="niveau" type="text" readonly style="text-align: center;" />  
<label for="nom_prenom">تمرينا</label> <br />
</fieldset>


<fieldset id="section-1">
<legend> المعلومات العامة </legend>
<label for="nom_prenom">الإسم الكامل :</label> 
<input id="nom_prenom" name="nom_prenom" type="text" /><br />
<label for="lycee">اسم الثانوية التأهيلية :</label> 
<input id="lycee" name="lycee" type="text" /> <br />
<label for="niveau">المستوى الدراسي :</label> 
<input id="niveau" name="niveau" type="text" value="" />  <br />
<label for="annee">السنة الدراسية :</label> 
<input id="annee" name="annee" type="text" value="" /> 
</fieldset>
<fieldset id="section-1">
<legend> شكل السلسلة </legend>
<label>شكل السلسلة :</label>
<select class="list" id = "list_style" onclick="Mon_Style(this.value)">
</select>
</fieldset>
<fieldset id="section-2">
<legend> إختيار التمارين </legend>
   <p>لإنشاء سلسلة التمارين يجب أولا إختيار المستوى الدراسي ثم بعد ذلك إسم الدرس وأخيرا التمارين (التمارين ستكون مرتبة في السلسلة حسب ترتيب اختيارها)</p>
<label>المستوى الدراسي :</label>
<select class="list" id = "list_niveau" onclick="Cours(this.value)">
	<option value="" selected disabled hidden>إختر المستوى الدراسي</option>;
	<option value='0'>الجذع المشترك العلمي</option>;
	<option value='1'>الأولى باك علوم تجريبية </option>;
	<option value='2'>الثانية باك علوم الحياة والأرض</option>;
</select>
<p />
<label>الدرس :</label>
<select class="list" id = "list_cours" onclick="Exercices(this.value)">
</select>

<p />
<label>التمارين :</label>

<table style="text-align: right; width: 100%; height: 31px;"
 border="1" cellpadding="0" cellspacing="0">
  <tbody>
    <tr>
      <td style="width: 20%;">
<div class="container" dir = "rtl" id = "list_exercices">
</div>
</td>
      <td style="width: 80%;">
<p dir="rtl" id="demo" style="margin-left:4px; margin-right:4px; width: auto;"></p>
<div id="bodydesc" style="margin-left:4px; margin-right:4px; width: auto; height: 550px; overflow-y: scroll; border-style: solid;">
<p dir="rtl" id="demo2" style="margin-left:4px; margin-right:4px; width: auto;"></p>
</div>
</td>
    </tr>
  </tbody>
</table>
</fieldset>
<form id = "form0" action="/" method="POST">
<input type="submit" />
</form>
<script src="dist.js" defer async></script>
<a dir="rtl" id="Lien" style="display: none"><span style="color:#0000FF;">T&eacute;l&eacute;charger la S&eacute;rie</span></a></p>
</fieldset>
<br/>
</fieldset>
<h3 style="text-align: center;">
من إنجاز نايت
الياس مجيد أستاذ بالثانوية
التأهلية وادي الذهب بالدار البيضاء
<br/>
gmail : naitlyassemjid@gmail.com
<br/>
 N&deg; : 0679668011&nbsp;
</h3>

<script>
window.addEventListener("load", function(event) {
//var stat = [0,0,0,0];
document.getElementById("tc").value = xml_str.getElementsByTagName("Niveau")[0].getElementsByTagName("Enonce").length;
document.getElementById("bac1").value = xml_str.getElementsByTagName("Niveau")[1].getElementsByTagName("Enonce").length;
document.getElementById("bac2").value = xml_str.getElementsByTagName("Niveau")[2].getElementsByTagName("Enonce").length;
//Charge les style ======================================
  var x=xml_str.getElementsByTagName("Style");
var list_style = document.getElementById("list_style");
var taille = list_style.length;
// remove
for(var i=0;i<taille;i++){
		list_style.remove(0);
}
//add element
for(var i=0;i<x.length;i++){
  var option = document.createElement("option");
  option.text = x[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;
  option.value = i;
  list_style.add(option);
 } 
 //======================================================
  });
  
if (window.XMLHttpRequest)
{ my_xml=new XMLHttpRequest();
}
else
{
my_xml=new ActiveXObject("Microsoft.XMLHTTP");
}
/////////////////////////////
my_xml.open("GET",'exercice2.xml',false);
my_xml.send();
xml_str=my_xml.responseXML;
var N=0;
var C=0;
var S = 0;
var Titre ="SansNom.tex";
var enonce="";
function Cours(niveau){
N=niveau;
EX_tab = [];
var x=xml_str.getElementsByTagName("Niveau");
var y=x[niveau].getElementsByTagName("Cours");
//var cours ='<select name=id>';
var list_cours = document.getElementById("list_cours");
var taille = list_cours.length;
// remove
for(var i=0;i<taille;i++){
		list_cours.remove(0);
}
//add element
for(var i=0;i<y.length;i++){
  var option = document.createElement("option");
  option.text = y[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;
  option.value = i;
  list_cours.add(option);
 }
 Exercices(0);
}
//Style serie =============================================================================================================
function Mon_Style(st){
S=st;
document.getElementById("tc").value = xml_str.getElementsByTagName("Niveau")[0].getElementsByTagName("Enonce").length;
document.getElementById("bac1").value = xml_str.getElementsByTagName("Niveau")[1].getElementsByTagName("Enonce").length;
document.getElementById("bac2").value = xml_str.getElementsByTagName("Niveau")[2].getElementsByTagName("Enonce").length;
// remove cours
var list_cour = document.getElementById("list_cours");
var taill = list_cours.length;
// remove
for(var i=0;i<taill;i++){
		list_cour.remove(0);
}
// remove exercices
var list_exercice = document.getElementById("list_exercices");
var taill = list_exercices.childNodes.length;
for(var i=0;i<taill;i++){
     list_exercice.removeChild(list_exercice.childNodes[0]);
}
document.getElementById("list_niveau").value =  document.getElementById("list_niveau")[0].value;
}
//=======================================================================================================================
//Exercices 
function Exercices(cours){
C=cours;
EX_tab = [];
var x=xml_str.getElementsByTagName("Niveau");
var y=x[N].getElementsByTagName("Cours");
var z=y[C].getElementsByTagName("Exercices")[0].getElementsByTagName("name");
Titre = y[C].getElementsByTagName("file")[0].childNodes[0].nodeValue;
//var cours ='<select name=id>';
  var list_exercices = document.getElementById("list_exercices");
  var taille = list_exercices.childNodes.length;
// remove
for(var i=0;i<taille;i++){
     list_exercices.removeChild(list_exercices.childNodes[0]);
}
//add element
for(var i=0;i<z.length;i++){
var ul = document.getElementById('list_exercices'); //ul
        var li = document.createElement('li');//li
        var text = z[i].childNodes[0].nodeValue;;
        var checkbox = document.createElement('input');
        checkbox.type = "checkbox";
        checkbox.name = "name";
        checkbox.value = i;
        checkbox.id = "ex";
		checkbox.onclick= function() { tabex(this);}
        li.appendChild(checkbox);
        li.appendChild(document.createTextNode(text));
        ul.appendChild(li); 
 }
}
//Generation de la table
var EX_tab = [];
function tabex(a) {
  if(a.checked){
  	EX_tab.push(a.value)
  }else { 
		for(var i = 0;i<EX_tab.length;i++){
			if (EX_tab[i] ==a.value){EX_tab.splice(i, 1);}
		}
}
//Generation file

//DEBUT ==========================================================
enonce = CodeBase64(xml_str.getElementsByTagName("debut")[S].childNodes[0].nodeValue)
enonce += CodeBase64("\n");
//INFO ===========================================================
var txt = CodeBase64(document.getElementById("annee").value);
txt += CodeBase64("}\n\\lhead{مادة : الفيزياء والكيمياء\\\\الأستاذ : ");
txt += CodeBase64(document.getElementById("nom_prenom").value);
txt += CodeBase64("}\n\\rhead{الثانوية التأهيلية  : " );
txt += CodeBase64(document.getElementById("lycee").value);
txt += CodeBase64("\\\\المستوى الدراسي  : ");
txt += CodeBase64(document.getElementById("niveau").value);
var nom_cours = document.getElementById("list_cours")[C].text;
txt += CodeBase64("}\n\\rfoot{");
txt += CodeBase64(nom_cours);
txt += CodeBase64("}\n\\lfoot{");
txt += CodeBase64(document.getElementById("niveau").value);
txt += CodeBase64("}\n");
txt += CodeBase64("\\chead{\\centering سلسلة تمارين\\\\ \n");
txt += CodeBase64(nom_cours); 
txt += CodeBase64("}\n\\begin{document}\n");
txt += CodeBase64("\n");
enonce += txt;
//EX  ============================================================
  for (var i = 0; i< EX_tab.length; i++) {
    enonce += CodeBase64(xml_str.getElementsByTagName("Niveau")[N].getElementsByTagName("Cours")[C].getElementsByTagName("Exercices")[0].getElementsByTagName("Enonce")[EX_tab[i]].childNodes[0].nodeValue);
	enonce +=CodeBase64("\n");
  }
  enonce += "ClxlbmR7ZG9jdW1lbnR9";
  enonce = atob(enonce);
//Affichier le resultat
var select_el = "التمارين المختارة مرتبة كالأتي : ";
select_e2 = "";
var tcbac12 = ["Tc","Bac1","Bac2"];
for(var i = 0;i<EX_tab.length-1;i++){ select_el += (Number(EX_tab[i])+1) +" - ";
select_e2 += "<p dir='rtl'><img alt='e"+ (Number(C)+1) +"'"+ (Number(EX_tab[i])+1) + " height='100%' src='images/"+ tcbac12[N] +"/p" + (Number(C)+1) + "/e" + (Number(EX_tab[i])+1) +".png' width='100%' /></p>";}
if(EX_tab.length>0){ select_el += (Number(EX_tab[EX_tab.length-1])+1);
select_e2 += "<p dir='rtl'><img alt='e"+ (Number(C)+1) +"'"+ (Number(EX_tab[i])+1) + " height='100%' src='images/"+ tcbac12[N] +"/p" + (Number(C)+1) + "/e" + (Number(EX_tab[i])+1) +".png' width='100%' /></p>";}
//select_el += "<br/>" + enonce;
 document.getElementById("demo").innerHTML = select_el;
 document.getElementById("demo2").innerHTML = select_e2;
}

function b64EncodeUnicode(str) {
    // first we use encodeURIComponent to get percent-encoded UTF-8,
    // then we convert the percent encodings into raw bytes which
    // can be fed into btoa.
    return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,
        function toSolidBytes(match, p1) {
            return String.fromCharCode('0x' + p1);
    }));
}
function CodeBase64(strOrigine) {
  var str = strOrigine;
  var enc = b64EncodeUnicode(str);
  while(enc.search("=") != "-1"){
 	 str += " ";
 	 enc = b64EncodeUnicode(str);
  }
  return enc;
}

</script>
</body>
</html>